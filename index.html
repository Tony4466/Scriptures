<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Scripture Guessing Game</title>
<style>
  /* Body with neutral background */
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    min-height: 100vh;
    padding-left: 20px;
    padding-right: 20px;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #f0f4f8; /* default menu background */
  }

  /* Wrapper: on menu, center container only and hide debug box */
  .wrapper {
    display: flex;
    gap: 20px;
    align-items: flex-start;
    padding: 20px;
    max-width: 1200px;
    width: 100%;
    box-sizing: border-box;
  }

  /* When menu is active: center container only */
  .wrapper.menu-active {
    justify-content: center;
    align-items: center;
  }

  /* Main container for content */
  .container {
    background-color: white;
    padding: 20px;
    border-radius: 15px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    max-width: 900px;
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  /* Debug box on side */
  .debug-box {
    background-color: white;
    padding: 20px 40px;
    border-radius: 15px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    max-width: 400px;
    width: 100%;
    font-size: 28px;
    text-align: left;
    transition: opacity 0.3s ease;
  }

  /* Hide debug box on menu */
  .debug-box.hidden {
    opacity: 0;
    pointer-events: none;
    width: 0 !important;
    padding: 0 !important;
    margin: 0 !important;
  }

  /* Main menu inside container */
  #mainMenu {
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  #mainMenu h1 {
    font-size: 2.8rem;
    color: #222;
    margin: 0 0 15px 0;
  }
  #mainMenu p {
    font-size: 1.1rem;
    color: #444;
    max-width: 500px;
    text-align: center;
    margin-bottom: 30px;
  }

  /* Menu buttons container - horizontal row with gaps */
  #menuButtons {
    display: flex;
    gap: 20px;
    justify-content: center;
    width: 100%;
    max-width: 700px;
  }

  .menu-button {
    flex: 1 1 0;
    padding: 15px 0;
    font-size: 1.3rem;
    font-weight: 600;
    border-radius: 10px;
    border: none;
    cursor: pointer;
    color: white;
    transition: background-color 0.3s ease;
    text-align: center;
  }
  #dailyBtn {
    background-color: #4a90e2; /* blue */
  }
  #dailyBtn:hover {
    background-color: #3a7bd5;
  }
  #randomBtn {
    background: linear-gradient(135deg, #79c267, #a4d48a); /* green gradient */
  }
  #randomBtn:hover {
    background: linear-gradient(135deg, #6bb15e, #92c374);
  }
  #customBtn {
    background: linear-gradient(135deg, #f18d48, #f9ac64); /* orange gradient */
  }
  #customBtn:hover {
    background: linear-gradient(135deg, #d97721, #e78b33);
  }

  /* Verse box styling (white) - narrower to fit container */
  #verseBox {
    background-color: white;
    border: 2px solid black;
    border-radius: 12px;
    font-size: 1.8rem;
    padding: 25px;
    min-height: 120px;
    width: 100%;
    max-width: 700px;
    margin-bottom: 20px;
    box-shadow: 0 3px 8px rgba(0,0,0,0.1);
    text-align: center;
    color: #222;
  }

  /* Input styling */
  input[type="text"] {
    font-size: 1.4rem;
    padding: 12px 15px;
    border-radius: 8px;
    border: 2px solid black;
    width: 100%;
    max-width: 600px;
    box-sizing: border-box;
    margin-bottom: 15px;
    text-align: center;
  }

  /* Buttons container for layout */
  .button-row {
    display: flex;
    gap: 15px;
    margin-bottom: 20px;
  }

  /* Buttons styling */
  button {
    font-size: 1.3rem;
    padding: 12px 25px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    color: white;
    transition: background-color 0.3s ease;
  }
  /* Blue button (Daily game) */
  .btn-blue {
    background-color: #4a90e2;
  }
  .btn-blue:hover:not(:disabled) {
    background-color: #3a7bd5;
  }
  /* Green button (Random game) */
  .btn-green {
    background: linear-gradient(135deg, #79c267, #a4d48a);
  }
  .btn-green:hover:not(:disabled) {
    background: linear-gradient(135deg, #6bb15e, #92c374);
  }
  /* Orange button (Custom game) */
  .btn-orange {
    background: linear-gradient(135deg, #f18d48, #f9ac64);
  }
  .btn-orange:hover:not(:disabled) {
    background: linear-gradient(135deg, #d97721, #e78b33);
  }
  /* Disabled button style: keep white text */
  button:disabled {
    background-color: #ccc !important;
    color: white !important;
    cursor: not-allowed;
    opacity: 0.7;
  }

  /* Correctness report text */
  #correctnessReport, #randomCorrectnessReport, #customCorrectnessReport {
    font-size: 1.2rem;
    font-weight: 600;
    min-height: 30px;
    margin-bottom: 10px;
    color: #222;
    text-align: center;
    max-width: 800px;
  }

  /* Progress bar container */
  .progress-container {
    width: 100%;
    max-width: 700px;
    height: 14px;
    background-color: #e0e0e0;
    border-radius: 7px;
    overflow: hidden;
    margin-bottom: 20px;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
  }
  .progress-bar {
    height: 100%;
    width: 0%;
    background-color: #6bbf59;
    transition: width 0.4s ease;
  }

  /* Hide sections except active */
  #dailyGame, #randomGame, #customGame {
    display: none;
    width: 100%;
    align-items: center;
    flex-direction: column;
  }

  /* Responsive adjustments */
  @media (max-width: 900px) {
    .wrapper {
      flex-direction: column;
      align-items: center;
    }
    .debug-box {
      font-size: 20px;
      padding: 15px 20px;
      max-width: 100%;
      width: 100%;
    }
    .container {
      max-width: 500px;
      width: 100%;
      padding: 15px;
    }
    #verseBox {
      font-size: 1.2rem;
      min-height: 100px;
      padding: 15px;
      max-width: 100%;
    }
    input[type="text"] {
      font-size: 1rem;
      max-width: 100%;
      padding: 10px;
    }
    button {
      font-size: 1rem;
      padding: 10px 18px;
    }
    .progress-container {
      max-width: 100%;
      height: 12px;
    }
    /* Menu buttons horizontally stacked on small screens */
    #menuButtons {
      flex-direction: column;
    }
  }
</style>
</head>
<body>

<div class="wrapper menu-active" id="wrapper">

  <!-- Main container: menu and games share this -->
  <div class="container">

    <!-- Main Menu -->
    <div id="mainMenu">
      <h1>Scripture Guessing Game</h1>
      <p>Choose your game mode:</p>
      <div id="menuButtons">
        <button id="dailyBtn" class="menu-button btn-blue" onclick="startDailyGame()">Daily Game</button>
        <button id="randomBtn" class="menu-button btn-green" onclick="startRandomGame()">Random Verses Game</button>
        <button id="customBtn" class="menu-button btn-orange" onclick="startCustomGame()">Custom Game</button>
      </div>
    </div>

    <!-- Daily Game -->
    <div id="dailyGame">
      <div class="progress-container" aria-label="Daily progress">
        <div class="progress-bar" id="progressBar"></div>
      </div>
      <div id="verseBox">Press "Show Verse" to start your daily challenge!</div>
      <input type="text" id="dailyInput" placeholder="Type the reference here..." autocomplete="off" spellcheck="false" />
      <div class="button-row">
        <button id="showVerseBtn" class="btn-blue" onclick="showDailyVerse()">Show Verse</button>
        <button id="checkRefBtn" class="btn-blue" onclick="checkDailyReference()" disabled>Check Reference</button>
      </div>
      <p id="correctnessReport"></p>
      <button class="btn-blue" style="margin-top:15px;" onclick="goBack()">← Back to Menu</button>
    </div>

    <!-- Random Game -->
    <div id="randomGame">
      <div id="verseBox">Press "Show Verse" to start guessing a random verse!</div>
      <input type="text" id="randomInput" placeholder="Type the reference here..." autocomplete="off" spellcheck="false" />
      <div class="button-row">
        <button id="showRandomVerseBtn" class="btn-green" onclick="showRandomVerse()">Show Verse</button>
        <button id="checkRandomRefBtn" class="btn-green" onclick="checkRandomReference()" disabled>Check Reference</button>
      </div>
      <p id="randomCorrectnessReport"></p>
      <button class="btn-green" style="margin-top:15px;" onclick="goBack()">← Back to Menu</button>
    </div>

    <!-- Custom Game -->
    <div id="customGame">
      <div id="verseBox">Press "Show Verse" to start your custom game!</div>
      <input type="text" id="customInput" placeholder="Type the reference here..." autocomplete="off" spellcheck="false" />
      <div class="button-row">
        <button id="showCustomVerseBtn" class="btn-orange" onclick="showCustomVerse()">Show Verse</button>
        <button id="checkCustomRefBtn" class="btn-orange" onclick="checkCustomReference()" disabled>Check Reference</button>
      </div>
      <p id="customCorrectnessReport"></p>
      <button class="btn-orange" style="margin-top:15px;" onclick="goBack()">← Back to Menu</button>
    </div>

  </div>

  <!-- Debug box on the side -->
  <div class="debug-box hidden" aria-live="polite" aria-atomic="true" id="debugBox">
    <p id="scoreDisplay">
      Current Average: 0<br />
      Total Score: 0<br />
      Attempts: 0
    </p>
  </div>
</div>

<script src="source.js"></script>
<script>
  // Elements
  const mainMenu = document.getElementById('mainMenu');
  const debugBox = document.getElementById('debugBox');
  const wrapper = document.getElementById('wrapper');

  // Daily mode elements
  const dailyGame = document.getElementById('dailyGame');
  const dailyVerseBox = dailyGame.querySelector('#verseBox');
  const dailyInput = dailyGame.querySelector('#dailyInput');
  const dailyShowBtn = dailyGame.querySelector('#showVerseBtn');
  const dailyCheckBtn = dailyGame.querySelector('#checkRefBtn');
  const dailyReport = dailyGame.querySelector('#correctnessReport');
  const progressBar = dailyGame.querySelector('#progressBar');

  // Random mode elements
  const randomGame = document.getElementById('randomGame');
  const randomVerseBox = randomGame.querySelector('#verseBox');
  const randomInput = randomGame.querySelector('#randomInput');
  const randomShowBtn = randomGame.querySelector('#showRandomVerseBtn');
  const randomCheckBtn = randomGame.querySelector('#checkRandomRefBtn');
  const randomReport = randomGame.querySelector('#randomCorrectnessReport');

  // Custom mode elements
  const customGame = document.getElementById('customGame');
  const customVerseBox = customGame.querySelector('#verseBox');
  const customInput = customGame.querySelector('#customInput');
  const customShowBtn = customGame.querySelector('#showCustomVerseBtn');
  const customCheckBtn = customGame.querySelector('#checkCustomRefBtn');
  const customReport = customGame.querySelector('#customCorrectnessReport');

  // Scores for display and update in debug box
  let scores = [];
  let totalScore = 0;

  // ---------- MAIN MENU ----------
  function startDailyGame() {
    mainMenu.style.display = 'none';
    dailyGame.style.display = 'flex';
    debugBox.classList.remove('hidden');
    wrapper.classList.remove('menu-active');
    resetDailyGame();
    setBodyBackground(true);
  }

  function startRandomGame() {
    mainMenu.style.display = 'none';
    randomGame.style.display = 'flex';
    debugBox.classList.remove('hidden');
    wrapper.classList.remove('menu-active');
    resetRandomGame();
    setBodyBackground(false);
  }

  function startCustomGame() {
    mainMenu.style.display = 'none';
    customGame.style.display = 'flex';
    debugBox.classList.remove('hidden');
    wrapper.classList.remove('menu-active');
    resetCustomGame();
    setBodyBackground('custom');
  }

  function goBack() {
    dailyGame.style.display = 'none';
    randomGame.style.display = 'none';
    customGame.style.display = 'none';
    mainMenu.style.display = 'flex';
    debugBox.classList.add('hidden');
    wrapper.classList.add('menu-active');
    setBodyBackground(null);
    resetDebug();
  }

  // ---------- BODY BACKGROUND ----------
  function setBodyBackground(mode) {
    if (mode === true) {
      // Blue gradient for daily game
      document.body.style.background = 'linear-gradient(135deg, #cce2ff, #f2f6ff, #b8c9fc)';
    } else if (mode === false) {
      // Green gradient for random game
      document.body.style.background = 'linear-gradient(135deg, #ccffdd, #f2fff6, #b8fcc9)';
    } else if (mode === 'custom') {
      // Orange gradient for custom game
      document.body.style.background = 'linear-gradient(135deg, #fce5d0, #fff7e6, #f9d9b1)';
    } else {
      // Default neutral background (menu)
      document.body.style.background = '#f0f4f8';
    }
  }

  // ---------- DAILY GAME LOGIC ----------
  let dailyIndexes = [];
  let dailyIndex = 0;
  let dailyScores = [];
  let dailyTotalScore = 0;

  function getDailySeed() {
    const today = new Date();
    return today.getFullYear() * 1000 + today.getMonth() * 50 + today.getDate();
  }

  function seededRandom(seed) {
    let x = Math.sin(seed) * 10000;
    return x - Math.floor(x);
  }

  function getDailyVerses() {
    let seed = getDailySeed();
    let indexes = [];
    for (let i = 0; i < 5; i++) {
      seed += i;
      let index = Math.floor(seededRandom(seed) * scriptures.length);
      indexes.push(index);
    }
    return indexes;
  }

  function resetDailyGame() {
    dailyIndexes = getDailyVerses();
    dailyIndex = 0;
    dailyScores = [];
    dailyTotalScore = 0;
    dailyVerseBox.textContent = 'Press "Show Verse" to start your daily challenge!';
    dailyInput.value = '';
    dailyReport.textContent = '';
    dailyCheckBtn.disabled = true;
    dailyShowBtn.disabled = false;
    updateProgressBar(0);
    resetDebug();
  }

  function showDailyVerse() {
    if (dailyIndex >= dailyIndexes.length) {
      dailyVerseBox.textContent = "That's all for today! Come back tomorrow for new verses.";
      dailyShowBtn.disabled = true;
      dailyCheckBtn.disabled = true;
      return;
    }
    const currentIdx = dailyIndexes[dailyIndex];
    dailyVerseBox.textContent = scriptures[currentIdx];
    dailyInput.value = '';
    dailyReport.textContent = '';
    dailyCheckBtn.disabled = false;
    dailyShowBtn.disabled = true;
  }

  function updateProgressBar(value) {
    progressBar.style.width = value + '%';
  }

  function checkDailyReference() {
    const input = dailyInput.value.trim().toLowerCase();
    const allRefsLower = references.map(ref => ref.toLowerCase());
    const currentIdx = dailyIndexes[dailyIndex];
    const correctRef = references[currentIdx].toLowerCase();
    let score = 0;

    if (input === correctRef) {
      score = 1000;
      dailyReport.innerHTML = `✅ You're right! That was ${references[currentIdx]}. Score: 1000/1000`;
      dailyReport.style.color = 'green';
    } else if (allRefsLower.includes(input)) {
      const userIdx = allRefsLower.indexOf(input);
      const distance = Math.abs(currentIdx - userIdx);
      const decayBase = Math.pow(1 / 1000, 1 / 3000);
      score = distance >= 3000 ? 0 : Math.round(1000 * Math.pow(decayBase, distance));
      dailyReport.innerHTML = `❌ You entered: "${references[userIdx]}"<br>Correct answer: "${references[currentIdx]}"<br>Score: ${score}/1000`;
      dailyReport.style.color = 'red';
    } else {
      dailyReport.innerHTML = `"${input}" doesn't match any scripture reference. Check your spelling and try again.`;
      dailyReport.style.color = 'black';
      return;
    }

    dailyScores.push(score);
    dailyTotalScore += score;
    updateDebug(dailyTotalScore, dailyScores.length);

    dailyIndex++;
    updateProgressBar((dailyIndex / dailyIndexes.length) * 100);

    dailyCheckBtn.disabled = true;
    dailyShowBtn.disabled = false;
  }

  // ---------- RANDOM GAME LOGIC ----------
  let randomCurrentIndex = null;
  let randomScores = [];
  let randomTotalScore = 0;

  function resetRandomGame() {
    randomCurrentIndex = null;
    randomScores = [];
    randomTotalScore = 0;
    randomVerseBox.textContent = 'Press "Show Verse" to start guessing a random verse!';
    randomInput.value = '';
    randomReport.textContent = '';
    randomCheckBtn.disabled = true;
    randomShowBtn.disabled = false;
    resetDebug();
  }

  function showRandomVerse() {
    randomCurrentIndex = Math.floor(Math.random() * scriptures.length);
    randomVerseBox.textContent = scriptures[randomCurrentIndex];
    randomInput.value = '';
    randomReport.textContent = '';
    randomCheckBtn.disabled = false;
    randomShowBtn.disabled = true;
  }

  function checkRandomReference() {
    const input = randomInput.value.trim().toLowerCase();
    const allRefsLower = references.map(ref => ref.toLowerCase());
    const correctRef = references[randomCurrentIndex].toLowerCase();
    let score = 0;

    if (input === correctRef) {
      score = 1000;
      randomReport.innerHTML = `✅ You're right! That was ${references[randomCurrentIndex]}. Score: 1000/1000`;
      randomReport.style.color = 'green';
    } else if (allRefsLower.includes(input)) {
      const userIdx = allRefsLower.indexOf(input);
      const distance = Math.abs(randomCurrentIndex - userIdx);
      const decayBase = Math.pow(1 / 1000, 1 / 3000);
      score = distance >= 3000 ? 0 : Math.round(1000 * Math.pow(decayBase, distance));
      randomReport.innerHTML = `❌ You entered: "${references[userIdx]}"<br>Correct answer: "${references[randomCurrentIndex]}"<br>Score: ${score}/1000`;
      randomReport.style.color = 'red';
    } else {
      randomReport.innerHTML = `"${input}" doesn't match any scripture reference. Check your spelling and try again.`;
      randomReport.style.color = 'black';
      return;
    }

    randomScores.push(score);
    randomTotalScore += score;
    updateDebug(randomTotalScore, randomScores.length);

    randomCheckBtn.disabled = true;
    randomShowBtn.disabled = false;
  }

  // ---------- CUSTOM GAME LOGIC (same as random for now) ----------
  let customCurrentIndex = null;
  let customScores = [];
  let customTotalScore = 0;

  function resetCustomGame() {
    customCurrentIndex = null;
    customScores = [];
    customTotalScore = 0;
    customVerseBox.textContent = 'Press "Show Verse" to start your custom game!';
    customInput.value = '';
    customReport.textContent = '';
    customCheckBtn.disabled = true;
    customShowBtn.disabled = false;
    resetDebug();
  }

  function showCustomVerse() {
    customCurrentIndex = Math.floor(Math.random() * scriptures.length);
    customVerseBox.textContent = scriptures[customCurrentIndex];
    customInput.value = '';
    customReport.textContent = '';
    customCheckBtn.disabled = false;
    customShowBtn.disabled = true;
  }

  function checkCustomReference() {
    const input = customInput.value.trim().toLowerCase();
    const allRefsLower = references.map(ref => ref.toLowerCase());
    const correctRef = references[customCurrentIndex].toLowerCase();
    let score = 0;

    if (input === correctRef) {
      score = 1000;
      customReport.innerHTML = `✅ You're right! That was ${references[customCurrentIndex]}. Score: 1000/1000`;
      customReport.style.color = 'green';
    } else if (allRefsLower.includes(input)) {
      const userIdx = allRefsLower.indexOf(input);
      const distance = Math.abs(customCurrentIndex - userIdx);
      const decayBase = Math.pow(1 / 1000, 1 / 3000);
      score = distance >= 3000 ? 0 : Math.round(1000 * Math.pow(decayBase, distance));
      customReport.innerHTML = `❌ You entered: "${references[userIdx]}"<br>Correct answer: "${references[customCurrentIndex]}"<br>Score: ${score}/1000`;
      customReport.style.color = 'red';
    } else {
      customReport.innerHTML = `"${input}" doesn't match any scripture reference. Check your spelling and try again.`;
      customReport.style.color = 'black';
      return;
    }

    customScores.push(score);
    customTotalScore += score;
    updateDebug(customTotalScore, customScores.length);

    customCheckBtn.disabled = true;
    customShowBtn.disabled = false;
  }

  // ---------- DEBUG UPDATE ----------
  function updateDebug(total, attempts) {
    let avg = attempts === 0 ? 0 : Math.round(total / attempts);
    document.getElementById('scoreDisplay').innerHTML = `
      Current Average: ${avg}<br />
      Total Score: ${total}<br />
      Attempts: ${attempts}
    `;
  }

  function resetDebug() {
    document.getElementById('scoreDisplay').innerHTML = `
      Current Average: 0<br />
      Total Score: 0<br />
      Attempts: 0
    `;
  }

  // Initialize menu and debug state
  window.onload = () => {
    mainMenu.style.display = 'flex';
    dailyGame.style.display = 'none';
    randomGame.style.display = 'none';
    customGame.style.display = 'none';
    debugBox.classList.add('hidden');
    wrapper.classList.add('menu-active');
    setBodyBackground(null);
    resetDebug();
  };
</script>
</body>
</html>
